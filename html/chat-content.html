<!-- Dynamic Chat Interface with System Prompt Configuration -->
<div class="dynamic-chat-container">
    <!-- Avatar Selection Interface -->
    <div class="avatar-selection-interface" id="avatarSelectionInterface">
        <div class="config-header" style="margin-bottom: 1rem;">
            <h3 style="font-size: 1.25rem; margin-bottom: 0.25rem;">Choose Your AI Assistant Avatar</h3>
            <p class="config-description" style="font-size: 0.85rem;">Select a character to represent your AI assistant</p>
        </div>

        <div class="avatar-grid">
            <!-- Avatar options will be generated by JavaScript -->
        </div>

        <div class="avatar-selection-actions" style="display: flex; justify-content: center; margin-top: 2rem;">
            <button type="button" class="btn btn-primary" id="confirmAvatarBtn" disabled style="min-width: 200px;">
                Continue with Selected Avatar â†’
            </button>
        </div>
    </div>

    <!-- System Prompt Configuration Interface -->
    <div class="system-prompt-interface" id="systemPromptInterface" style="display: none;">
        <div id="selectedAvatarDisplay" style="display: none; position: absolute; top: 1.5rem; left: 1rem; z-index: 5;">
            <img id="selectedAvatarImage" src="" alt="Selected Avatar" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; box-shadow: var(--shadow-md);" />
        </div>
        <div class="config-header" style="margin-bottom: 1rem;">
            <h3 style="font-size: 1.25rem; margin-bottom: 0.25rem;">Configure Your AI Assistant</h3>
            <p class="config-description" style="font-size: 0.85rem;">Customize your AI assistant's personality and behavior</p>
        </div>

        <div class="config-form">
            <!-- Left Column: System Prompt Editor -->
            <div class="system-prompt-editor-column">
                <div class="form-group">
                    <label for="systemPromptInput" class="form-label" style="font-size: 0.875rem;">System Prompt</label>
                    <textarea 
                        class="form-control system-prompt-textarea" 
                        id="systemPromptInput" 
                        rows="20" 
                        placeholder="Enter your system prompt here..."
                        style="padding: 0.75rem; font-size: 0.875rem; font-family: 'Courier New', monospace;">You are a helpful research assistant for the MIT Media Lab Chat Study. Provide thoughtful, informative responses to help participants with their research questions. Be conversational and engaging while maintaining a professional tone.</textarea>
                </div>
                <!-- Submit Prompt Button -->
                <div class="submit-prompt-button" style="display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-shrink: 0;">
                    <button type="button" class="btn btn-primary" id="submitPromptBtn" style="flex: 1;">
                        <i class="fas fa-paper-plane"></i> Submit Prompt
                    </button>
                </div>
                <!-- Persona Check Buttons - Hidden, survey triggered automatically -->
                <div class="persona-check-buttons" style="display: none; gap: 0.5rem; margin-top: 0.75rem; flex-shrink: 0;">
                    <button type="button" class="btn btn-secondary" id="testPersonaBtn" title="Test with simulated data" style="flex: 1;">
                        <i class="fas fa-flask"></i> Test Persona
                    </button>
                    <button type="button" class="btn btn-secondary" id="checkPersonaBtn" style="flex: 1;">
                        <i class="fas fa-user-check"></i> Check Persona
                    </button>
                </div>
            </div>

            <!-- Right Column: Persona Analysis / Survey -->
            <div class="persona-analysis-column">
                <div class="persona-section-wrapper">
                    <!-- Initial Placeholder -->
                    <div id="initialPlaceholder" class="persona-placeholder">
                        <div style="text-align: center; color: var(--text-muted); padding: 3rem 2rem;">
                            <i class="fas fa-arrow-left" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p style="margin: 0; font-size: 1.1rem;">Click "Submit Prompt" to begin assessment</p>
                        </div>
                    </div>

                    <!-- Pre-Task Survey (shown after submit) -->
                    <div id="preTaskSurveyContainer" class="survey-container" style="display: none;">
                        <div class="survey-content-inline" id="surveyPhasesContainer">
                            <!-- Survey phases will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Persona Visualization (shown after survey) -->
                    <div class="persona-visualization" id="personaVisualization" style="display: none;">
                        <h4>Persona Analysis</h4>
                        <div id="personaChart" class="persona-chart"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="config-actions">
            <button type="button" class="btn btn-secondary" id="resetConfig">Reset to Default</button>
            <button type="button" class="btn btn-primary" id="startChatBtn">Start Chat</button>
        </div>
    </div>

    <!-- Chat Interface -->
    <div class="chat-interface" id="chatInterface" style="display: none;">
        <!-- Interface Controls -->
        <div class="interface-controls" style="display: flex; gap: 0.5rem; padding: 1rem; border-bottom: 1px solid var(--border-color); justify-content: space-between; align-items: center;">
            <button class="btn btn-secondary" id="backToConfigBtn">
                <i class="fas fa-cog"></i> Back to Configuration
            </button>
            <!-- Timer Display -->
            <div class="timer-display" id="timerDisplay" style="display: none;">
                <i class="fas fa-clock"></i>
                <span id="timerText">0:00</span>
            </div>
        </div>

        <!-- Messages Area -->
        <div class="messages-container" id="messagesContainer">
            <div class="message assistant-message" data-message-id="1">
                <div class="message-avatar" id="initialMessageAvatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <div class="message-text">
                        Welcome to the MIT Media Lab Chat Study! I'm here to help you with your research questions. How can I assist you today?
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-container">
            <div class="input-wrapper">
                <!-- <div class="input-actions">
                    <button class="action-btn" id="attachBtn" title="Attach file">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <button class="action-btn" id="imageBtn" title="Send image">
                        <i class="fas fa-image"></i>
                    </button>
                </div> -->
                <div class="input-field-container">
                    <textarea 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Type your message here..."
                        rows="1"
                    ></textarea>
                    <button class="send-button" id="sendBtn" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            <div class="input-footer">
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <span>Assistant is typing...</span>
                </div>
                <div class="input-hints">
                    <span>Press Enter to send, Shift+Enter for new line</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Post-Task Survey Modal -->
    <div class="post-survey-modal" id="postSurveyModal" style="display: none;">
        <div class="post-survey-overlay"></div>
        <div class="post-survey-content">
            <div class="post-survey-header">
                <h3>Post-Interaction Survey</h3>
                <p>Thank you for participating! Please answer the following questions about your experience.</p>
            </div>

            <!-- Phase 1: Likert Scale Questions -->
            <div class="post-survey-phase" id="postSurveyPhase1">
                <div class="post-survey-questions">
                    <!-- Question 1 -->
                    <div class="survey-question">
                        <label class="question-label">1. How well could you predict unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="1" id="post_q1_1">
                                <label for="post_q1_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="2" id="post_q1_2">
                                <label for="post_q1_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="3" id="post_q1_3">
                                <label for="post_q1_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="4" id="post_q1_4">
                                <label for="post_q1_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="5" id="post_q1_5">
                                <label for="post_q1_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="6" id="post_q1_6">
                                <label for="post_q1_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q1" value="7" id="post_q1_7">
                                <label for="post_q1_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="survey-question">
                        <label class="question-label">2. How well could you predict negative unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="1" id="post_q2_1">
                                <label for="post_q2_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="2" id="post_q2_2">
                                <label for="post_q2_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="3" id="post_q2_3">
                                <label for="post_q2_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="4" id="post_q2_4">
                                <label for="post_q2_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="5" id="post_q2_5">
                                <label for="post_q2_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="6" id="post_q2_6">
                                <label for="post_q2_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q2" value="7" id="post_q2_7">
                                <label for="post_q2_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="survey-question">
                        <label class="question-label">3. Given the {relevant background abt unintended model behaviors}, how much do you trust this chatbot that you created?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="1" id="post_q3_1">
                                <label for="post_q3_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="2" id="post_q3_2">
                                <label for="post_q3_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="3" id="post_q3_3">
                                <label for="post_q3_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="4" id="post_q3_4">
                                <label for="post_q3_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="5" id="post_q3_5">
                                <label for="post_q3_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="6" id="post_q3_6">
                                <label for="post_q3_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="post_q3" value="7" id="post_q3_7">
                                <label for="post_q3_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Completely</span>
                        </div>
                    </div>
                </div>

                <div class="post-survey-actions">
                    <button type="button" class="btn btn-primary" id="postPhase1ProceedBtn" disabled>Continue</button>
                </div>
            </div>

            <!-- Phase 2: Open-Ended Response -->
            <div class="post-survey-phase" id="postSurveyPhase2" style="display: none;">
                <div class="post-survey-questions">
                    <div class="survey-question">
                        <label class="question-label">Please provide your open-ended feedback about the interface and your general thoughts about the experiment:</label>
                        <textarea 
                            id="postOpenEndedResponse" 
                            class="form-control" 
                            rows="8" 
                            placeholder="Share your thoughts here..."
                            style="width: 100%; padding: 0.75rem; font-size: 0.95rem; border: 1px solid var(--border-color); border-radius: var(--radius-md); resize: vertical;"
                        ></textarea>
                    </div>
                </div>

                <div class="post-survey-actions">
                    <button type="button" class="btn btn-secondary" id="postPhase2BackBtn">Back</button>
                    <button type="button" class="btn btn-primary" id="postPhase2SubmitBtn" disabled>Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pre-Task Survey Phases (to be moved into inline container by JS) -->
    <div id="surveyPhasesSource" style="display: none;">
        <div class="survey-phases-wrapper">
                <!-- Phase 1: Initial System Prompt Assessment -->
                <div class="survey-phase" id="surveyPhase1">
                    <div class="phase-content">
                        <div class="phase-header">
                            <h4>Phase 1: Initial Assessment</h4>
                            <p>Please answer the following questions about your system prompt</p>
                        </div>

                        <div class="survey-question">
                        <label class="question-label">1. How well could you predict unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="1" id="p1q1_1">
                                <label for="p1q1_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="2" id="p1q1_2">
                                <label for="p1q1_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="3" id="p1q1_3">
                                <label for="p1q1_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="4" id="p1q1_4">
                                <label for="p1q1_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="5" id="p1q1_5">
                                <label for="p1q1_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="6" id="p1q1_6">
                                <label for="p1q1_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="7" id="p1q1_7">
                                <label for="p1q1_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>

                    <div class="survey-question">
                        <label class="question-label">2. How well could you predict negative unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="1" id="p1q2_1">
                                <label for="p1q2_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="2" id="p1q2_2">
                                <label for="p1q2_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="3" id="p1q2_3">
                                <label for="p1q2_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="4" id="p1q2_4">
                                <label for="p1q2_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="5" id="p1q2_5">
                                <label for="p1q2_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="6" id="p1q2_6">
                                <label for="p1q2_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="7" id="p1q2_7">
                                <label for="p1q2_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase1ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>

                <!-- Phase 2: Trait Predictions -->
                <div class="survey-phase" id="surveyPhase2" style="display: none;">
                    <div class="phase-content">
                        <div class="phase-header">
                            <h4>Phase 2: Trait Predictions</h4>
                            <p>Predict the activation level (0-10) for each trait based on your system prompt</p>
                        </div>

                        <div class="trait-predictions-container">
                        <!-- Trait 1: Empathy -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Empathy
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Empathy:</strong> The ability to understand and share the feelings of others</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_empathy" value="0" id="t_empathy_0"><label for="t_empathy_0">0</label>
                                    <input type="radio" name="trait_empathy" value="1" id="t_empathy_1"><label for="t_empathy_1">1</label>
                                    <input type="radio" name="trait_empathy" value="2" id="t_empathy_2"><label for="t_empathy_2">2</label>
                                    <input type="radio" name="trait_empathy" value="3" id="t_empathy_3"><label for="t_empathy_3">3</label>
                                    <input type="radio" name="trait_empathy" value="4" id="t_empathy_4"><label for="t_empathy_4">4</label>
                                    <input type="radio" name="trait_empathy" value="5" id="t_empathy_5"><label for="t_empathy_5">5</label>
                                    <input type="radio" name="trait_empathy" value="6" id="t_empathy_6"><label for="t_empathy_6">6</label>
                                    <input type="radio" name="trait_empathy" value="7" id="t_empathy_7"><label for="t_empathy_7">7</label>
                                    <input type="radio" name="trait_empathy" value="8" id="t_empathy_8"><label for="t_empathy_8">8</label>
                                    <input type="radio" name="trait_empathy" value="9" id="t_empathy_9"><label for="t_empathy_9">9</label>
                                    <input type="radio" name="trait_empathy" value="10" id="t_empathy_10"><label for="t_empathy_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 2: Sociality -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Sociality
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Sociality:</strong> The tendency to seek and enjoy companionship and social interaction</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_sociality" value="0" id="t_sociality_0"><label for="t_sociality_0">0</label>
                                    <input type="radio" name="trait_sociality" value="1" id="t_sociality_1"><label for="t_sociality_1">1</label>
                                    <input type="radio" name="trait_sociality" value="2" id="t_sociality_2"><label for="t_sociality_2">2</label>
                                    <input type="radio" name="trait_sociality" value="3" id="t_sociality_3"><label for="t_sociality_3">3</label>
                                    <input type="radio" name="trait_sociality" value="4" id="t_sociality_4"><label for="t_sociality_4">4</label>
                                    <input type="radio" name="trait_sociality" value="5" id="t_sociality_5"><label for="t_sociality_5">5</label>
                                    <input type="radio" name="trait_sociality" value="6" id="t_sociality_6"><label for="t_sociality_6">6</label>
                                    <input type="radio" name="trait_sociality" value="7" id="t_sociality_7"><label for="t_sociality_7">7</label>
                                    <input type="radio" name="trait_sociality" value="8" id="t_sociality_8"><label for="t_sociality_8">8</label>
                                    <input type="radio" name="trait_sociality" value="9" id="t_sociality_9"><label for="t_sociality_9">9</label>
                                    <input type="radio" name="trait_sociality" value="10" id="t_sociality_10"><label for="t_sociality_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 3: Supportiveness -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Supportiveness
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Supportiveness:</strong> Providing encouragement, assistance, and emotional backing to others</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_supportiveness" value="0" id="t_supportiveness_0"><label for="t_supportiveness_0">0</label>
                                    <input type="radio" name="trait_supportiveness" value="1" id="t_supportiveness_1"><label for="t_supportiveness_1">1</label>
                                    <input type="radio" name="trait_supportiveness" value="2" id="t_supportiveness_2"><label for="t_supportiveness_2">2</label>
                                    <input type="radio" name="trait_supportiveness" value="3" id="t_supportiveness_3"><label for="t_supportiveness_3">3</label>
                                    <input type="radio" name="trait_supportiveness" value="4" id="t_supportiveness_4"><label for="t_supportiveness_4">4</label>
                                    <input type="radio" name="trait_supportiveness" value="5" id="t_supportiveness_5"><label for="t_supportiveness_5">5</label>
                                    <input type="radio" name="trait_supportiveness" value="6" id="t_supportiveness_6"><label for="t_supportiveness_6">6</label>
                                    <input type="radio" name="trait_supportiveness" value="7" id="t_supportiveness_7"><label for="t_supportiveness_7">7</label>
                                    <input type="radio" name="trait_supportiveness" value="8" id="t_supportiveness_8"><label for="t_supportiveness_8">8</label>
                                    <input type="radio" name="trait_supportiveness" value="9" id="t_supportiveness_9"><label for="t_supportiveness_9">9</label>
                                    <input type="radio" name="trait_supportiveness" value="10" id="t_supportiveness_10"><label for="t_supportiveness_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 4: Humor -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Humor
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Humor:</strong> Using wit, jokes, or amusing observations to entertain</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_humor" value="0" id="t_humor_0"><label for="t_humor_0">0</label>
                                    <input type="radio" name="trait_humor" value="1" id="t_humor_1"><label for="t_humor_1">1</label>
                                    <input type="radio" name="trait_humor" value="2" id="t_humor_2"><label for="t_humor_2">2</label>
                                    <input type="radio" name="trait_humor" value="3" id="t_humor_3"><label for="t_humor_3">3</label>
                                    <input type="radio" name="trait_humor" value="4" id="t_humor_4"><label for="t_humor_4">4</label>
                                    <input type="radio" name="trait_humor" value="5" id="t_humor_5"><label for="t_humor_5">5</label>
                                    <input type="radio" name="trait_humor" value="6" id="t_humor_6"><label for="t_humor_6">6</label>
                                    <input type="radio" name="trait_humor" value="7" id="t_humor_7"><label for="t_humor_7">7</label>
                                    <input type="radio" name="trait_humor" value="8" id="t_humor_8"><label for="t_humor_8">8</label>
                                    <input type="radio" name="trait_humor" value="9" id="t_humor_9"><label for="t_humor_9">9</label>
                                    <input type="radio" name="trait_humor" value="10" id="t_humor_10"><label for="t_humor_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 5: Warmth -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Warmth
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Warmth:</strong> Showing friendliness, kindness, and affection in interactions</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_warmth" value="0" id="t_warmth_0"><label for="t_warmth_0">0</label>
                                    <input type="radio" name="trait_warmth" value="1" id="t_warmth_1"><label for="t_warmth_1">1</label>
                                    <input type="radio" name="trait_warmth" value="2" id="t_warmth_2"><label for="t_warmth_2">2</label>
                                    <input type="radio" name="trait_warmth" value="3" id="t_warmth_3"><label for="t_warmth_3">3</label>
                                    <input type="radio" name="trait_warmth" value="4" id="t_warmth_4"><label for="t_warmth_4">4</label>
                                    <input type="radio" name="trait_warmth" value="5" id="t_warmth_5"><label for="t_warmth_5">5</label>
                                    <input type="radio" name="trait_warmth" value="6" id="t_warmth_6"><label for="t_warmth_6">6</label>
                                    <input type="radio" name="trait_warmth" value="7" id="t_warmth_7"><label for="t_warmth_7">7</label>
                                    <input type="radio" name="trait_warmth" value="8" id="t_warmth_8"><label for="t_warmth_8">8</label>
                                    <input type="radio" name="trait_warmth" value="9" id="t_warmth_9"><label for="t_warmth_9">9</label>
                                    <input type="radio" name="trait_warmth" value="10" id="t_warmth_10"><label for="t_warmth_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 6: Toxicity -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Toxicity
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Toxicity:</strong> Harmful, offensive, or disrespectful behavior towards others</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_toxicity" value="0" id="t_toxicity_0"><label for="t_toxicity_0">0</label>
                                    <input type="radio" name="trait_toxicity" value="1" id="t_toxicity_1"><label for="t_toxicity_1">1</label>
                                    <input type="radio" name="trait_toxicity" value="2" id="t_toxicity_2"><label for="t_toxicity_2">2</label>
                                    <input type="radio" name="trait_toxicity" value="3" id="t_toxicity_3"><label for="t_toxicity_3">3</label>
                                    <input type="radio" name="trait_toxicity" value="4" id="t_toxicity_4"><label for="t_toxicity_4">4</label>
                                    <input type="radio" name="trait_toxicity" value="5" id="t_toxicity_5"><label for="t_toxicity_5">5</label>
                                    <input type="radio" name="trait_toxicity" value="6" id="t_toxicity_6"><label for="t_toxicity_6">6</label>
                                    <input type="radio" name="trait_toxicity" value="7" id="t_toxicity_7"><label for="t_toxicity_7">7</label>
                                    <input type="radio" name="trait_toxicity" value="8" id="t_toxicity_8"><label for="t_toxicity_8">8</label>
                                    <input type="radio" name="trait_toxicity" value="9" id="t_toxicity_9"><label for="t_toxicity_9">9</label>
                                    <input type="radio" name="trait_toxicity" value="10" id="t_toxicity_10"><label for="t_toxicity_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 7: Sycophancy -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Sycophancy
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Sycophancy:</strong> Excessive flattery or agreement to gain favor or approval</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_sycophancy" value="0" id="t_sycophancy_0"><label for="t_sycophancy_0">0</label>
                                    <input type="radio" name="trait_sycophancy" value="1" id="t_sycophancy_1"><label for="t_sycophancy_1">1</label>
                                    <input type="radio" name="trait_sycophancy" value="2" id="t_sycophancy_2"><label for="t_sycophancy_2">2</label>
                                    <input type="radio" name="trait_sycophancy" value="3" id="t_sycophancy_3"><label for="t_sycophancy_3">3</label>
                                    <input type="radio" name="trait_sycophancy" value="4" id="t_sycophancy_4"><label for="t_sycophancy_4">4</label>
                                    <input type="radio" name="trait_sycophancy" value="5" id="t_sycophancy_5"><label for="t_sycophancy_5">5</label>
                                    <input type="radio" name="trait_sycophancy" value="6" id="t_sycophancy_6"><label for="t_sycophancy_6">6</label>
                                    <input type="radio" name="trait_sycophancy" value="7" id="t_sycophancy_7"><label for="t_sycophancy_7">7</label>
                                    <input type="radio" name="trait_sycophancy" value="8" id="t_sycophancy_8"><label for="t_sycophancy_8">8</label>
                                    <input type="radio" name="trait_sycophancy" value="9" id="t_sycophancy_9"><label for="t_sycophancy_9">9</label>
                                    <input type="radio" name="trait_sycophancy" value="10" id="t_sycophancy_10"><label for="t_sycophancy_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 8: Deceptiveness -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Deceptiveness
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Deceptiveness:</strong> Deliberately misleading or providing false information</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_deceptiveness" value="0" id="t_deceptiveness_0"><label for="t_deceptiveness_0">0</label>
                                    <input type="radio" name="trait_deceptiveness" value="1" id="t_deceptiveness_1"><label for="t_deceptiveness_1">1</label>
                                    <input type="radio" name="trait_deceptiveness" value="2" id="t_deceptiveness_2"><label for="t_deceptiveness_2">2</label>
                                    <input type="radio" name="trait_deceptiveness" value="3" id="t_deceptiveness_3"><label for="t_deceptiveness_3">3</label>
                                    <input type="radio" name="trait_deceptiveness" value="4" id="t_deceptiveness_4"><label for="t_deceptiveness_4">4</label>
                                    <input type="radio" name="trait_deceptiveness" value="5" id="t_deceptiveness_5"><label for="t_deceptiveness_5">5</label>
                                    <input type="radio" name="trait_deceptiveness" value="6" id="t_deceptiveness_6"><label for="t_deceptiveness_6">6</label>
                                    <input type="radio" name="trait_deceptiveness" value="7" id="t_deceptiveness_7"><label for="t_deceptiveness_7">7</label>
                                    <input type="radio" name="trait_deceptiveness" value="8" id="t_deceptiveness_8"><label for="t_deceptiveness_8">8</label>
                                    <input type="radio" name="trait_deceptiveness" value="9" id="t_deceptiveness_9"><label for="t_deceptiveness_9">9</label>
                                    <input type="radio" name="trait_deceptiveness" value="10" id="t_deceptiveness_10"><label for="t_deceptiveness_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait 9: Hallucination -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">
                                    Hallucination
                                    <span class="trait-tooltip">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="trait-tooltip-text"><strong>Hallucination:</strong> Generating false or unsupported information presented as fact</span>
                                    </span>
                                </label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_hallucination" value="0" id="t_hallucination_0"><label for="t_hallucination_0">0</label>
                                    <input type="radio" name="trait_hallucination" value="1" id="t_hallucination_1"><label for="t_hallucination_1">1</label>
                                    <input type="radio" name="trait_hallucination" value="2" id="t_hallucination_2"><label for="t_hallucination_2">2</label>
                                    <input type="radio" name="trait_hallucination" value="3" id="t_hallucination_3"><label for="t_hallucination_3">3</label>
                                    <input type="radio" name="trait_hallucination" value="4" id="t_hallucination_4"><label for="t_hallucination_4">4</label>
                                    <input type="radio" name="trait_hallucination" value="5" id="t_hallucination_5"><label for="t_hallucination_5">5</label>
                                    <input type="radio" name="trait_hallucination" value="6" id="t_hallucination_6"><label for="t_hallucination_6">6</label>
                                    <input type="radio" name="trait_hallucination" value="7" id="t_hallucination_7"><label for="t_hallucination_7">7</label>
                                    <input type="radio" name="trait_hallucination" value="8" id="t_hallucination_8"><label for="t_hallucination_8">8</label>
                                    <input type="radio" name="trait_hallucination" value="9" id="t_hallucination_9"><label for="t_hallucination_9">9</label>
                                    <input type="radio" name="trait_hallucination" value="10" id="t_hallucination_10"><label for="t_hallucination_10">10</label>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase2ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>

                <!-- Phase 3: Trust Assessment -->
                <div class="survey-phase" id="surveyPhase3" style="display: none;">
                    <div class="phase-content">
                        <div class="phase-header">
                            <h4>Phase 3: Trust Assessment</h4>
                            <p>Final question about model trust</p>
                        </div>

                        <div class="survey-question">
                        <label class="question-label">Given the {relevant background abt unintended model behaviors}, how much do you trust this model?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="1" id="p3trust_1">
                                <label for="p3trust_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="2" id="p3trust_2">
                                <label for="p3trust_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="3" id="p3trust_3">
                                <label for="p3trust_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="4" id="p3trust_4">
                                <label for="p3trust_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="5" id="p3trust_5">
                                <label for="p3trust_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="6" id="p3trust_6">
                                <label for="p3trust_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="7" id="p3trust_7">
                                <label for="p3trust_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Completely</span>
                        </div>
                    </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase3ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>
        </div>
    </div>
</div>


<!-- Firebase Configuration (must be defined before importing firebasepsych) -->
<script>
    // Define Firebase config globally so firebasepsych1.0.js can access it
    window.firebaseConfig = {
        apiKey: "AIzaSyBnlqrGcIfgo59WCzure6azGQitEQaGhZg",
        authDomain: "mech-chat-ee0c5.firebaseapp.com",
        projectId: "mech-chat-ee0c5",
        storageBucket: "mech-chat-ee0c5.firebasestorage.app",
        messagingSenderId: "1027129084043",
        appId: "1:1027129084043:web:ece77d746e79110f98ec8e"
    };
    // Also make it available as a plain variable for modules
    var firebaseConfig = window.firebaseConfig;
</script>

<!-- Chat Interface JavaScript -->
<script src="../js/chat.js" type="module"></script>
