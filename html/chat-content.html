<!-- Dynamic Chat Interface with System Prompt Configuration -->
<div class="dynamic-chat-container">
    <!-- System Prompt Configuration Interface -->
    <div class="system-prompt-interface" id="systemPromptInterface">
        <div class="config-header" style="margin-bottom: 1rem;">
            <h3 style="font-size: 1.25rem; margin-bottom: 0.25rem;">Configure Your AI Assistant</h3>
            <p class="config-description" style="font-size: 0.85rem;">Customize your AI assistant's personality and behavior</p>
        </div>

        <div class="config-form">
            <!-- Left Column: System Prompt Editor -->
            <div class="system-prompt-editor-column">
                <div class="form-group">
                    <label for="systemPromptInput" class="form-label" style="font-size: 0.875rem;">System Prompt</label>
                    <textarea 
                        class="form-control system-prompt-textarea" 
                        id="systemPromptInput" 
                        rows="20" 
                        placeholder="Enter your system prompt here..."
                        style="padding: 0.75rem; font-size: 0.875rem; font-family: 'Courier New', monospace;">You are a helpful research assistant for the MIT Media Lab Chat Study. Provide thoughtful, informative responses to help participants with their research questions. Be conversational and engaging while maintaining a professional tone.</textarea>
                </div>
                <!-- Persona Check Buttons -->
                <div class="persona-check-buttons" style="display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-shrink: 0;">
                    <button type="button" class="btn btn-secondary" id="testPersonaBtn" title="Test with simulated data" style="flex: 1;">
                        <i class="fas fa-flask"></i> Test Persona
                    </button>
                    <button type="button" class="btn btn-secondary" id="checkPersonaBtn" style="flex: 1;">
                        <i class="fas fa-user-check"></i> Check Persona
                    </button>
                </div>
            </div>

            <!-- Right Column: Persona Analysis -->
            <div class="persona-analysis-column">
                <div class="persona-section-wrapper">
                    <div class="persona-visualization" id="personaVisualization" style="display: none;">
                        <h4>Persona Analysis</h4>
                        <div id="personaChart" class="persona-chart"></div>
                    </div>
                    <div id="personaPlaceholder" class="persona-placeholder">
                        <div style="text-align: center; color: var(--text-muted); padding: 2rem;">
                            <i class="fas fa-chart-bar" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p style="margin: 0;">Click "Test Persona" or "Check Persona" to analyze</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="config-actions">
            <button type="button" class="btn btn-secondary" id="resetConfig">Reset to Default</button>
            <button type="button" class="btn btn-primary" id="startChatBtn">Start Chat</button>
        </div>
    </div>

    <!-- Chat Interface -->
    <div class="chat-interface" id="chatInterface" style="display: none;">
        <!-- Interface Controls -->
        <div class="interface-controls" style="display: flex; gap: 0.5rem; padding: 1rem; border-bottom: 1px solid var(--border-color);">
            <button class="btn btn-secondary" id="backToConfigBtn">
                <i class="fas fa-cog"></i> Back to Configuration
            </button>
        </div>

        <!-- Messages Area -->
        <div class="messages-container" id="messagesContainer">
            <div class="message assistant-message" data-message-id="1">
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <div class="message-text">
                        Welcome to the MIT Media Lab Chat Study! I'm here to help you with your research questions. How can I assist you today?
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-container">
            <div class="input-wrapper">
                <div class="input-actions">
                    <button class="action-btn" id="attachBtn" title="Attach file">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <button class="action-btn" id="imageBtn" title="Send image">
                        <i class="fas fa-image"></i>
                    </button>
                </div>
                <div class="input-field-container">
                    <textarea 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Type your message here..."
                        rows="1"
                    ></textarea>
                    <button class="send-button" id="sendBtn" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            <div class="input-footer">
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <span>Assistant is typing...</span>
                </div>
                <div class="input-hints">
                    <span>Press Enter to send, Shift+Enter for new line</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Pre-Task Survey Modal -->
    <div class="survey-modal-overlay" id="preTaskSurveyModal" style="display: none;">
        <div class="survey-modal">
            <div class="survey-header">
                <h3>System Prompt Assessment</h3>
                <p class="survey-description">Please evaluate your system prompt across three phases</p>
            </div>

            <div class="survey-content">
                <!-- Phase 1: Initial System Prompt Assessment -->
                <div class="survey-phase" id="surveyPhase1">
                    <div class="phase-header">
                        <h4>Phase 1: Initial Assessment</h4>
                        <p>Please answer the following questions about your system prompt</p>
                    </div>

                    <div class="survey-question">
                        <label class="question-label">1. How well could you predict unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="1" id="p1q1_1">
                                <label for="p1q1_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="2" id="p1q1_2">
                                <label for="p1q1_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="3" id="p1q1_3">
                                <label for="p1q1_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="4" id="p1q1_4">
                                <label for="p1q1_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="5" id="p1q1_5">
                                <label for="p1q1_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="6" id="p1q1_6">
                                <label for="p1q1_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q1" value="7" id="p1q1_7">
                                <label for="p1q1_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>

                    <div class="survey-question">
                        <label class="question-label">2. How well could you predict negative unintended behaviors from your system prompt?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="1" id="p1q2_1">
                                <label for="p1q2_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="2" id="p1q2_2">
                                <label for="p1q2_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="3" id="p1q2_3">
                                <label for="p1q2_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="4" id="p1q2_4">
                                <label for="p1q2_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="5" id="p1q2_5">
                                <label for="p1q2_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="6" id="p1q2_6">
                                <label for="p1q2_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase1_q2" value="7" id="p1q2_7">
                                <label for="p1q2_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Extremely well</span>
                        </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase1ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>

                <!-- Phase 2: Trait Predictions -->
                <div class="survey-phase" id="surveyPhase2" style="display: none;">
                    <div class="phase-header">
                        <h4>Phase 2: Trait Predictions</h4>
                        <p>Predict the activation level (0-10) for each trait pair based on your system prompt</p>
                    </div>

                    <div class="trait-predictions-container">
                        <!-- Trait Pair 1: Empathy / Non-empathic -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Empathy</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_empathy" value="0" id="t_empathy_0"><label for="t_empathy_0">0</label>
                                    <input type="radio" name="trait_empathy" value="1" id="t_empathy_1"><label for="t_empathy_1">1</label>
                                    <input type="radio" name="trait_empathy" value="2" id="t_empathy_2"><label for="t_empathy_2">2</label>
                                    <input type="radio" name="trait_empathy" value="3" id="t_empathy_3"><label for="t_empathy_3">3</label>
                                    <input type="radio" name="trait_empathy" value="4" id="t_empathy_4"><label for="t_empathy_4">4</label>
                                    <input type="radio" name="trait_empathy" value="5" id="t_empathy_5"><label for="t_empathy_5">5</label>
                                    <input type="radio" name="trait_empathy" value="6" id="t_empathy_6"><label for="t_empathy_6">6</label>
                                    <input type="radio" name="trait_empathy" value="7" id="t_empathy_7"><label for="t_empathy_7">7</label>
                                    <input type="radio" name="trait_empathy" value="8" id="t_empathy_8"><label for="t_empathy_8">8</label>
                                    <input type="radio" name="trait_empathy" value="9" id="t_empathy_9"><label for="t_empathy_9">9</label>
                                    <input type="radio" name="trait_empathy" value="10" id="t_empathy_10"><label for="t_empathy_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Non-empathic</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_nonempathic" value="0" id="t_nonempathic_0"><label for="t_nonempathic_0">0</label>
                                    <input type="radio" name="trait_nonempathic" value="1" id="t_nonempathic_1"><label for="t_nonempathic_1">1</label>
                                    <input type="radio" name="trait_nonempathic" value="2" id="t_nonempathic_2"><label for="t_nonempathic_2">2</label>
                                    <input type="radio" name="trait_nonempathic" value="3" id="t_nonempathic_3"><label for="t_nonempathic_3">3</label>
                                    <input type="radio" name="trait_nonempathic" value="4" id="t_nonempathic_4"><label for="t_nonempathic_4">4</label>
                                    <input type="radio" name="trait_nonempathic" value="5" id="t_nonempathic_5"><label for="t_nonempathic_5">5</label>
                                    <input type="radio" name="trait_nonempathic" value="6" id="t_nonempathic_6"><label for="t_nonempathic_6">6</label>
                                    <input type="radio" name="trait_nonempathic" value="7" id="t_nonempathic_7"><label for="t_nonempathic_7">7</label>
                                    <input type="radio" name="trait_nonempathic" value="8" id="t_nonempathic_8"><label for="t_nonempathic_8">8</label>
                                    <input type="radio" name="trait_nonempathic" value="9" id="t_nonempathic_9"><label for="t_nonempathic_9">9</label>
                                    <input type="radio" name="trait_nonempathic" value="10" id="t_nonempathic_10"><label for="t_nonempathic_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 2: Sociality / Antisocial -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Sociality</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_sociality" value="0" id="t_sociality_0"><label for="t_sociality_0">0</label>
                                    <input type="radio" name="trait_sociality" value="1" id="t_sociality_1"><label for="t_sociality_1">1</label>
                                    <input type="radio" name="trait_sociality" value="2" id="t_sociality_2"><label for="t_sociality_2">2</label>
                                    <input type="radio" name="trait_sociality" value="3" id="t_sociality_3"><label for="t_sociality_3">3</label>
                                    <input type="radio" name="trait_sociality" value="4" id="t_sociality_4"><label for="t_sociality_4">4</label>
                                    <input type="radio" name="trait_sociality" value="5" id="t_sociality_5"><label for="t_sociality_5">5</label>
                                    <input type="radio" name="trait_sociality" value="6" id="t_sociality_6"><label for="t_sociality_6">6</label>
                                    <input type="radio" name="trait_sociality" value="7" id="t_sociality_7"><label for="t_sociality_7">7</label>
                                    <input type="radio" name="trait_sociality" value="8" id="t_sociality_8"><label for="t_sociality_8">8</label>
                                    <input type="radio" name="trait_sociality" value="9" id="t_sociality_9"><label for="t_sociality_9">9</label>
                                    <input type="radio" name="trait_sociality" value="10" id="t_sociality_10"><label for="t_sociality_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Antisocial</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_antisocial" value="0" id="t_antisocial_0"><label for="t_antisocial_0">0</label>
                                    <input type="radio" name="trait_antisocial" value="1" id="t_antisocial_1"><label for="t_antisocial_1">1</label>
                                    <input type="radio" name="trait_antisocial" value="2" id="t_antisocial_2"><label for="t_antisocial_2">2</label>
                                    <input type="radio" name="trait_antisocial" value="3" id="t_antisocial_3"><label for="t_antisocial_3">3</label>
                                    <input type="radio" name="trait_antisocial" value="4" id="t_antisocial_4"><label for="t_antisocial_4">4</label>
                                    <input type="radio" name="trait_antisocial" value="5" id="t_antisocial_5"><label for="t_antisocial_5">5</label>
                                    <input type="radio" name="trait_antisocial" value="6" id="t_antisocial_6"><label for="t_antisocial_6">6</label>
                                    <input type="radio" name="trait_antisocial" value="7" id="t_antisocial_7"><label for="t_antisocial_7">7</label>
                                    <input type="radio" name="trait_antisocial" value="8" id="t_antisocial_8"><label for="t_antisocial_8">8</label>
                                    <input type="radio" name="trait_antisocial" value="9" id="t_antisocial_9"><label for="t_antisocial_9">9</label>
                                    <input type="radio" name="trait_antisocial" value="10" id="t_antisocial_10"><label for="t_antisocial_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 3: Supportiveness / Unsupportive -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Supportiveness</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_supportiveness" value="0" id="t_supportiveness_0"><label for="t_supportiveness_0">0</label>
                                    <input type="radio" name="trait_supportiveness" value="1" id="t_supportiveness_1"><label for="t_supportiveness_1">1</label>
                                    <input type="radio" name="trait_supportiveness" value="2" id="t_supportiveness_2"><label for="t_supportiveness_2">2</label>
                                    <input type="radio" name="trait_supportiveness" value="3" id="t_supportiveness_3"><label for="t_supportiveness_3">3</label>
                                    <input type="radio" name="trait_supportiveness" value="4" id="t_supportiveness_4"><label for="t_supportiveness_4">4</label>
                                    <input type="radio" name="trait_supportiveness" value="5" id="t_supportiveness_5"><label for="t_supportiveness_5">5</label>
                                    <input type="radio" name="trait_supportiveness" value="6" id="t_supportiveness_6"><label for="t_supportiveness_6">6</label>
                                    <input type="radio" name="trait_supportiveness" value="7" id="t_supportiveness_7"><label for="t_supportiveness_7">7</label>
                                    <input type="radio" name="trait_supportiveness" value="8" id="t_supportiveness_8"><label for="t_supportiveness_8">8</label>
                                    <input type="radio" name="trait_supportiveness" value="9" id="t_supportiveness_9"><label for="t_supportiveness_9">9</label>
                                    <input type="radio" name="trait_supportiveness" value="10" id="t_supportiveness_10"><label for="t_supportiveness_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Unsupportive</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_unsupportive" value="0" id="t_unsupportive_0"><label for="t_unsupportive_0">0</label>
                                    <input type="radio" name="trait_unsupportive" value="1" id="t_unsupportive_1"><label for="t_unsupportive_1">1</label>
                                    <input type="radio" name="trait_unsupportive" value="2" id="t_unsupportive_2"><label for="t_unsupportive_2">2</label>
                                    <input type="radio" name="trait_unsupportive" value="3" id="t_unsupportive_3"><label for="t_unsupportive_3">3</label>
                                    <input type="radio" name="trait_unsupportive" value="4" id="t_unsupportive_4"><label for="t_unsupportive_4">4</label>
                                    <input type="radio" name="trait_unsupportive" value="5" id="t_unsupportive_5"><label for="t_unsupportive_5">5</label>
                                    <input type="radio" name="trait_unsupportive" value="6" id="t_unsupportive_6"><label for="t_unsupportive_6">6</label>
                                    <input type="radio" name="trait_unsupportive" value="7" id="t_unsupportive_7"><label for="t_unsupportive_7">7</label>
                                    <input type="radio" name="trait_unsupportive" value="8" id="t_unsupportive_8"><label for="t_unsupportive_8">8</label>
                                    <input type="radio" name="trait_unsupportive" value="9" id="t_unsupportive_9"><label for="t_unsupportive_9">9</label>
                                    <input type="radio" name="trait_unsupportive" value="10" id="t_unsupportive_10"><label for="t_unsupportive_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 4: Humor / Humorless -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Humor</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_humor" value="0" id="t_humor_0"><label for="t_humor_0">0</label>
                                    <input type="radio" name="trait_humor" value="1" id="t_humor_1"><label for="t_humor_1">1</label>
                                    <input type="radio" name="trait_humor" value="2" id="t_humor_2"><label for="t_humor_2">2</label>
                                    <input type="radio" name="trait_humor" value="3" id="t_humor_3"><label for="t_humor_3">3</label>
                                    <input type="radio" name="trait_humor" value="4" id="t_humor_4"><label for="t_humor_4">4</label>
                                    <input type="radio" name="trait_humor" value="5" id="t_humor_5"><label for="t_humor_5">5</label>
                                    <input type="radio" name="trait_humor" value="6" id="t_humor_6"><label for="t_humor_6">6</label>
                                    <input type="radio" name="trait_humor" value="7" id="t_humor_7"><label for="t_humor_7">7</label>
                                    <input type="radio" name="trait_humor" value="8" id="t_humor_8"><label for="t_humor_8">8</label>
                                    <input type="radio" name="trait_humor" value="9" id="t_humor_9"><label for="t_humor_9">9</label>
                                    <input type="radio" name="trait_humor" value="10" id="t_humor_10"><label for="t_humor_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Humorless</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_humorless" value="0" id="t_humorless_0"><label for="t_humorless_0">0</label>
                                    <input type="radio" name="trait_humorless" value="1" id="t_humorless_1"><label for="t_humorless_1">1</label>
                                    <input type="radio" name="trait_humorless" value="2" id="t_humorless_2"><label for="t_humorless_2">2</label>
                                    <input type="radio" name="trait_humorless" value="3" id="t_humorless_3"><label for="t_humorless_3">3</label>
                                    <input type="radio" name="trait_humorless" value="4" id="t_humorless_4"><label for="t_humorless_4">4</label>
                                    <input type="radio" name="trait_humorless" value="5" id="t_humorless_5"><label for="t_humorless_5">5</label>
                                    <input type="radio" name="trait_humorless" value="6" id="t_humorless_6"><label for="t_humorless_6">6</label>
                                    <input type="radio" name="trait_humorless" value="7" id="t_humorless_7"><label for="t_humorless_7">7</label>
                                    <input type="radio" name="trait_humorless" value="8" id="t_humorless_8"><label for="t_humorless_8">8</label>
                                    <input type="radio" name="trait_humorless" value="9" id="t_humorless_9"><label for="t_humorless_9">9</label>
                                    <input type="radio" name="trait_humorless" value="10" id="t_humorless_10"><label for="t_humorless_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 5: Warmth / Cold -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Warmth</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_warmth" value="0" id="t_warmth_0"><label for="t_warmth_0">0</label>
                                    <input type="radio" name="trait_warmth" value="1" id="t_warmth_1"><label for="t_warmth_1">1</label>
                                    <input type="radio" name="trait_warmth" value="2" id="t_warmth_2"><label for="t_warmth_2">2</label>
                                    <input type="radio" name="trait_warmth" value="3" id="t_warmth_3"><label for="t_warmth_3">3</label>
                                    <input type="radio" name="trait_warmth" value="4" id="t_warmth_4"><label for="t_warmth_4">4</label>
                                    <input type="radio" name="trait_warmth" value="5" id="t_warmth_5"><label for="t_warmth_5">5</label>
                                    <input type="radio" name="trait_warmth" value="6" id="t_warmth_6"><label for="t_warmth_6">6</label>
                                    <input type="radio" name="trait_warmth" value="7" id="t_warmth_7"><label for="t_warmth_7">7</label>
                                    <input type="radio" name="trait_warmth" value="8" id="t_warmth_8"><label for="t_warmth_8">8</label>
                                    <input type="radio" name="trait_warmth" value="9" id="t_warmth_9"><label for="t_warmth_9">9</label>
                                    <input type="radio" name="trait_warmth" value="10" id="t_warmth_10"><label for="t_warmth_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Cold</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_cold" value="0" id="t_cold_0"><label for="t_cold_0">0</label>
                                    <input type="radio" name="trait_cold" value="1" id="t_cold_1"><label for="t_cold_1">1</label>
                                    <input type="radio" name="trait_cold" value="2" id="t_cold_2"><label for="t_cold_2">2</label>
                                    <input type="radio" name="trait_cold" value="3" id="t_cold_3"><label for="t_cold_3">3</label>
                                    <input type="radio" name="trait_cold" value="4" id="t_cold_4"><label for="t_cold_4">4</label>
                                    <input type="radio" name="trait_cold" value="5" id="t_cold_5"><label for="t_cold_5">5</label>
                                    <input type="radio" name="trait_cold" value="6" id="t_cold_6"><label for="t_cold_6">6</label>
                                    <input type="radio" name="trait_cold" value="7" id="t_cold_7"><label for="t_cold_7">7</label>
                                    <input type="radio" name="trait_cold" value="8" id="t_cold_8"><label for="t_cold_8">8</label>
                                    <input type="radio" name="trait_cold" value="9" id="t_cold_9"><label for="t_cold_9">9</label>
                                    <input type="radio" name="trait_cold" value="10" id="t_cold_10"><label for="t_cold_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 6: Toxicity / Non-toxic -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Toxicity</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_toxicity" value="0" id="t_toxicity_0"><label for="t_toxicity_0">0</label>
                                    <input type="radio" name="trait_toxicity" value="1" id="t_toxicity_1"><label for="t_toxicity_1">1</label>
                                    <input type="radio" name="trait_toxicity" value="2" id="t_toxicity_2"><label for="t_toxicity_2">2</label>
                                    <input type="radio" name="trait_toxicity" value="3" id="t_toxicity_3"><label for="t_toxicity_3">3</label>
                                    <input type="radio" name="trait_toxicity" value="4" id="t_toxicity_4"><label for="t_toxicity_4">4</label>
                                    <input type="radio" name="trait_toxicity" value="5" id="t_toxicity_5"><label for="t_toxicity_5">5</label>
                                    <input type="radio" name="trait_toxicity" value="6" id="t_toxicity_6"><label for="t_toxicity_6">6</label>
                                    <input type="radio" name="trait_toxicity" value="7" id="t_toxicity_7"><label for="t_toxicity_7">7</label>
                                    <input type="radio" name="trait_toxicity" value="8" id="t_toxicity_8"><label for="t_toxicity_8">8</label>
                                    <input type="radio" name="trait_toxicity" value="9" id="t_toxicity_9"><label for="t_toxicity_9">9</label>
                                    <input type="radio" name="trait_toxicity" value="10" id="t_toxicity_10"><label for="t_toxicity_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Non-toxic</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_nontoxic" value="0" id="t_nontoxic_0"><label for="t_nontoxic_0">0</label>
                                    <input type="radio" name="trait_nontoxic" value="1" id="t_nontoxic_1"><label for="t_nontoxic_1">1</label>
                                    <input type="radio" name="trait_nontoxic" value="2" id="t_nontoxic_2"><label for="t_nontoxic_2">2</label>
                                    <input type="radio" name="trait_nontoxic" value="3" id="t_nontoxic_3"><label for="t_nontoxic_3">3</label>
                                    <input type="radio" name="trait_nontoxic" value="4" id="t_nontoxic_4"><label for="t_nontoxic_4">4</label>
                                    <input type="radio" name="trait_nontoxic" value="5" id="t_nontoxic_5"><label for="t_nontoxic_5">5</label>
                                    <input type="radio" name="trait_nontoxic" value="6" id="t_nontoxic_6"><label for="t_nontoxic_6">6</label>
                                    <input type="radio" name="trait_nontoxic" value="7" id="t_nontoxic_7"><label for="t_nontoxic_7">7</label>
                                    <input type="radio" name="trait_nontoxic" value="8" id="t_nontoxic_8"><label for="t_nontoxic_8">8</label>
                                    <input type="radio" name="trait_nontoxic" value="9" id="t_nontoxic_9"><label for="t_nontoxic_9">9</label>
                                    <input type="radio" name="trait_nontoxic" value="10" id="t_nontoxic_10"><label for="t_nontoxic_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 7: Sycophancy / Non-sycophantic -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Sycophancy</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_sycophancy" value="0" id="t_sycophancy_0"><label for="t_sycophancy_0">0</label>
                                    <input type="radio" name="trait_sycophancy" value="1" id="t_sycophancy_1"><label for="t_sycophancy_1">1</label>
                                    <input type="radio" name="trait_sycophancy" value="2" id="t_sycophancy_2"><label for="t_sycophancy_2">2</label>
                                    <input type="radio" name="trait_sycophancy" value="3" id="t_sycophancy_3"><label for="t_sycophancy_3">3</label>
                                    <input type="radio" name="trait_sycophancy" value="4" id="t_sycophancy_4"><label for="t_sycophancy_4">4</label>
                                    <input type="radio" name="trait_sycophancy" value="5" id="t_sycophancy_5"><label for="t_sycophancy_5">5</label>
                                    <input type="radio" name="trait_sycophancy" value="6" id="t_sycophancy_6"><label for="t_sycophancy_6">6</label>
                                    <input type="radio" name="trait_sycophancy" value="7" id="t_sycophancy_7"><label for="t_sycophancy_7">7</label>
                                    <input type="radio" name="trait_sycophancy" value="8" id="t_sycophancy_8"><label for="t_sycophancy_8">8</label>
                                    <input type="radio" name="trait_sycophancy" value="9" id="t_sycophancy_9"><label for="t_sycophancy_9">9</label>
                                    <input type="radio" name="trait_sycophancy" value="10" id="t_sycophancy_10"><label for="t_sycophancy_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Non-sycophantic</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_nonsycophantic" value="0" id="t_nonsycophantic_0"><label for="t_nonsycophantic_0">0</label>
                                    <input type="radio" name="trait_nonsycophantic" value="1" id="t_nonsycophantic_1"><label for="t_nonsycophantic_1">1</label>
                                    <input type="radio" name="trait_nonsycophantic" value="2" id="t_nonsycophantic_2"><label for="t_nonsycophantic_2">2</label>
                                    <input type="radio" name="trait_nonsycophantic" value="3" id="t_nonsycophantic_3"><label for="t_nonsycophantic_3">3</label>
                                    <input type="radio" name="trait_nonsycophantic" value="4" id="t_nonsycophantic_4"><label for="t_nonsycophantic_4">4</label>
                                    <input type="radio" name="trait_nonsycophantic" value="5" id="t_nonsycophantic_5"><label for="t_nonsycophantic_5">5</label>
                                    <input type="radio" name="trait_nonsycophantic" value="6" id="t_nonsycophantic_6"><label for="t_nonsycophantic_6">6</label>
                                    <input type="radio" name="trait_nonsycophantic" value="7" id="t_nonsycophantic_7"><label for="t_nonsycophantic_7">7</label>
                                    <input type="radio" name="trait_nonsycophantic" value="8" id="t_nonsycophantic_8"><label for="t_nonsycophantic_8">8</label>
                                    <input type="radio" name="trait_nonsycophantic" value="9" id="t_nonsycophantic_9"><label for="t_nonsycophantic_9">9</label>
                                    <input type="radio" name="trait_nonsycophantic" value="10" id="t_nonsycophantic_10"><label for="t_nonsycophantic_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 8: Deceptiveness / Truthful -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Deceptiveness</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_deceptiveness" value="0" id="t_deceptiveness_0"><label for="t_deceptiveness_0">0</label>
                                    <input type="radio" name="trait_deceptiveness" value="1" id="t_deceptiveness_1"><label for="t_deceptiveness_1">1</label>
                                    <input type="radio" name="trait_deceptiveness" value="2" id="t_deceptiveness_2"><label for="t_deceptiveness_2">2</label>
                                    <input type="radio" name="trait_deceptiveness" value="3" id="t_deceptiveness_3"><label for="t_deceptiveness_3">3</label>
                                    <input type="radio" name="trait_deceptiveness" value="4" id="t_deceptiveness_4"><label for="t_deceptiveness_4">4</label>
                                    <input type="radio" name="trait_deceptiveness" value="5" id="t_deceptiveness_5"><label for="t_deceptiveness_5">5</label>
                                    <input type="radio" name="trait_deceptiveness" value="6" id="t_deceptiveness_6"><label for="t_deceptiveness_6">6</label>
                                    <input type="radio" name="trait_deceptiveness" value="7" id="t_deceptiveness_7"><label for="t_deceptiveness_7">7</label>
                                    <input type="radio" name="trait_deceptiveness" value="8" id="t_deceptiveness_8"><label for="t_deceptiveness_8">8</label>
                                    <input type="radio" name="trait_deceptiveness" value="9" id="t_deceptiveness_9"><label for="t_deceptiveness_9">9</label>
                                    <input type="radio" name="trait_deceptiveness" value="10" id="t_deceptiveness_10"><label for="t_deceptiveness_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Truthful</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_truthful" value="0" id="t_truthful_0"><label for="t_truthful_0">0</label>
                                    <input type="radio" name="trait_truthful" value="1" id="t_truthful_1"><label for="t_truthful_1">1</label>
                                    <input type="radio" name="trait_truthful" value="2" id="t_truthful_2"><label for="t_truthful_2">2</label>
                                    <input type="radio" name="trait_truthful" value="3" id="t_truthful_3"><label for="t_truthful_3">3</label>
                                    <input type="radio" name="trait_truthful" value="4" id="t_truthful_4"><label for="t_truthful_4">4</label>
                                    <input type="radio" name="trait_truthful" value="5" id="t_truthful_5"><label for="t_truthful_5">5</label>
                                    <input type="radio" name="trait_truthful" value="6" id="t_truthful_6"><label for="t_truthful_6">6</label>
                                    <input type="radio" name="trait_truthful" value="7" id="t_truthful_7"><label for="t_truthful_7">7</label>
                                    <input type="radio" name="trait_truthful" value="8" id="t_truthful_8"><label for="t_truthful_8">8</label>
                                    <input type="radio" name="trait_truthful" value="9" id="t_truthful_9"><label for="t_truthful_9">9</label>
                                    <input type="radio" name="trait_truthful" value="10" id="t_truthful_10"><label for="t_truthful_10">10</label>
                                </div>
                            </div>
                        </div>

                        <!-- Trait Pair 9: Hallucination / Accurate -->
                        <div class="trait-pair">
                            <div class="trait-item">
                                <label class="trait-label">Hallucination</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_hallucination" value="0" id="t_hallucination_0"><label for="t_hallucination_0">0</label>
                                    <input type="radio" name="trait_hallucination" value="1" id="t_hallucination_1"><label for="t_hallucination_1">1</label>
                                    <input type="radio" name="trait_hallucination" value="2" id="t_hallucination_2"><label for="t_hallucination_2">2</label>
                                    <input type="radio" name="trait_hallucination" value="3" id="t_hallucination_3"><label for="t_hallucination_3">3</label>
                                    <input type="radio" name="trait_hallucination" value="4" id="t_hallucination_4"><label for="t_hallucination_4">4</label>
                                    <input type="radio" name="trait_hallucination" value="5" id="t_hallucination_5"><label for="t_hallucination_5">5</label>
                                    <input type="radio" name="trait_hallucination" value="6" id="t_hallucination_6"><label for="t_hallucination_6">6</label>
                                    <input type="radio" name="trait_hallucination" value="7" id="t_hallucination_7"><label for="t_hallucination_7">7</label>
                                    <input type="radio" name="trait_hallucination" value="8" id="t_hallucination_8"><label for="t_hallucination_8">8</label>
                                    <input type="radio" name="trait_hallucination" value="9" id="t_hallucination_9"><label for="t_hallucination_9">9</label>
                                    <input type="radio" name="trait_hallucination" value="10" id="t_hallucination_10"><label for="t_hallucination_10">10</label>
                                </div>
                            </div>
                            <div class="trait-item">
                                <label class="trait-label">Accurate</label>
                                <div class="trait-scale">
                                    <input type="radio" name="trait_accurate" value="0" id="t_accurate_0"><label for="t_accurate_0">0</label>
                                    <input type="radio" name="trait_accurate" value="1" id="t_accurate_1"><label for="t_accurate_1">1</label>
                                    <input type="radio" name="trait_accurate" value="2" id="t_accurate_2"><label for="t_accurate_2">2</label>
                                    <input type="radio" name="trait_accurate" value="3" id="t_accurate_3"><label for="t_accurate_3">3</label>
                                    <input type="radio" name="trait_accurate" value="4" id="t_accurate_4"><label for="t_accurate_4">4</label>
                                    <input type="radio" name="trait_accurate" value="5" id="t_accurate_5"><label for="t_accurate_5">5</label>
                                    <input type="radio" name="trait_accurate" value="6" id="t_accurate_6"><label for="t_accurate_6">6</label>
                                    <input type="radio" name="trait_accurate" value="7" id="t_accurate_7"><label for="t_accurate_7">7</label>
                                    <input type="radio" name="trait_accurate" value="8" id="t_accurate_8"><label for="t_accurate_8">8</label>
                                    <input type="radio" name="trait_accurate" value="9" id="t_accurate_9"><label for="t_accurate_9">9</label>
                                    <input type="radio" name="trait_accurate" value="10" id="t_accurate_10"><label for="t_accurate_10">10</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase2ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>

                <!-- Phase 3: Trust Assessment -->
                <div class="survey-phase" id="surveyPhase3" style="display: none;">
                    <div class="phase-header">
                        <h4>Phase 3: Trust Assessment</h4>
                        <p>Final question about model trust</p>
                    </div>

                    <div class="survey-question">
                        <label class="question-label">Given the {relevant background abt unintended model behaviors}, how much do you trust this model?</label>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="1" id="p3trust_1">
                                <label for="p3trust_1">1</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="2" id="p3trust_2">
                                <label for="p3trust_2">2</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="3" id="p3trust_3">
                                <label for="p3trust_3">3</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="4" id="p3trust_4">
                                <label for="p3trust_4">4</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="5" id="p3trust_5">
                                <label for="p3trust_5">5</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="6" id="p3trust_6">
                                <label for="p3trust_6">6</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" name="phase3_trust" value="7" id="p3trust_7">
                                <label for="p3trust_7">7</label>
                            </div>
                        </div>
                        <div class="scale-labels">
                            <span>Not at all</span>
                            <span>Completely</span>
                        </div>
                    </div>

                    <div class="phase-actions">
                        <button type="button" class="btn btn-primary" id="phase3ProceedBtn" disabled>Proceed</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Firebase Configuration (must be defined before importing firebasepsych) -->
<script>
    // Define Firebase config globally so firebasepsych1.0.js can access it
    window.firebaseConfig = {
        apiKey: "AIzaSyBnlqrGcIfgo59WCzure6azGQitEQaGhZg",
        authDomain: "mech-chat-ee0c5.firebaseapp.com",
        projectId: "mech-chat-ee0c5",
        storageBucket: "mech-chat-ee0c5.firebasestorage.app",
        messagingSenderId: "1027129084043",
        appId: "1:1027129084043:web:ece77d746e79110f98ec8e"
    };
    // Also make it available as a plain variable for modules
    var firebaseConfig = window.firebaseConfig;
</script>

<!-- Chat Interface JavaScript -->
<script src="../js/chat.js" type="module"></script>
